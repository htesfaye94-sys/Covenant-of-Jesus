/**
 * ============================================================================
 * [COVENANT OF JESUS: INSTITUTIONAL CORE V6.0]
 * ============================================================================
 * Framework: React.js (Component-Based)
 * Styling: Advanced CSS-in-JS / Modular CSS
 * Purpose: Professional Scholastic Research Portal
 * ============================================================================
 */

import React, { useState, useEffect, useRef } from 'react';

/* ----------------------------------------------------------------------------
   [CSS MODULE: DESIGN SYSTEM]
   In a production environment, this would be global.css
   ---------------------------------------------------------------------------- */
const STYLES = `
:root {
  --color-void: #020101;
  --color-altar: #0c0808;
  --color-sepia: #1a1414;
  --gold-primary: #c5a059;
  --gold-bright: #f1dfb5;
  --gold-deep: #8e6d2f;
  --gold-burnished: #5c4a26;
  --parchment: #fcf9f2;
  --ink: #0d0606;
  --nav-h: 90px;
  --ease-royal: cubic-bezier(0.19, 1, 0.22, 1);
  --shadow-vault: 0 40px 100px rgba(0,0,0,0.8);
}

/* Base Body Logic */
.covenant-app {
  background: var(--color-void);
  color: white;
  font-family: 'Faustina', serif;
  overflow: hidden;
  height: 100vh;
}

/* Custom Scroll Engine */
.scroll-viewport {
  height: 100vh;
  overflow-y: auto;
  scroll-snap-type: y mandatory;
  scroll-behavior: smooth;
}

/* [COMPONENT: NAVIGATION] */
.site-header {
  position: fixed; top: 0; width: 100%; height: var(--nav-h);
  background: rgba(2, 1, 1, 0.98);
  backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
  border-bottom: 1px solid var(--gold-burnished);
  z-index: 10000; display: flex; align-items: center; justify-content: center;
  transition: transform 0.6s var(--ease-royal);
}

.nav-rail { display: flex; gap: 15px; padding: 0 40px; }

.nav-btn {
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(197, 160, 89, 0.15);
  padding: 12px 25px; cursor: pointer; text-decoration: none;
  display: flex; flex-direction: column; align-items: center;
  transition: 0.3s var(--ease-royal);
}

.nav-btn h4 { 
  font-family: 'Cinzel', serif; font-size: 0.65rem; 
  color: var(--gold-primary); letter-spacing: 2px; text-transform: uppercase;
}

.nav-btn span { 
  font-family: 'Noto Sans Ethiopic'; font-size: 0.6rem; 
  opacity: 0.5; color: white; margin-top: 2px;
}

.nav-btn.active { background: var(--gold-primary); border-color: white; }
.nav-btn.active h4, .nav-btn.active span { color: black; opacity: 1; font-weight: 800; }

/* [COMPONENT: THE VAULT] */
.vault-section {
  min-height: 100vh; width: 100%; display: flex; align-items: center; 
  justify-content: center; scroll-snap-align: start; padding: 100px 20px;
  position: relative;
}

.glass-vault {
  background: rgba(12, 8, 8, 0.85);
  backdrop-filter: blur(30px); border: 1px solid rgba(197, 160, 89, 0.15);
  box-shadow: var(--shadow-vault);
  width: 100%; max-width: 1250px; padding: clamp(40px, 8vh, 100px);
  position: relative; border-radius: 4px; z-index: 10;
}

/* [COMPONENT: EXPANDING PILLARS] */
.pillar-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; }

.pillar-card {
  background: var(--parchment); color: var(--ink); padding: 50px 40px;
  cursor: pointer; text-align: center; border-bottom: 8px solid var(--color-void);
  transition: 0.5s var(--ease-royal); position: relative;
}

.pillar-card:hover { transform: translateY(-10px); border-bottom-color: var(--gold-primary); }

.pillar-card i { font-size: 3rem; color: var(--gold-deep); margin-bottom: 25px; }

.pillar-drawer {
  max-height: 0; overflow: hidden; opacity: 0;
  transition: max-height 0.8s var(--ease-royal), opacity 0.5s;
  text-align: left;
}

.pillar-card.is-active { background: white; border-bottom-color: var(--gold-primary); }
.pillar-card.is-active .pillar-drawer { max-height: 500px; opacity: 1; margin-top: 30px; padding-top: 25px; border-top: 1px solid #ddd; }

/* [COMPONENT: ARCHIVE] */
.archive-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }

.archive-tile {
  background: var(--parchment); padding: 40px 20px; text-decoration: none;
  color: var(--ink); border-bottom: 5px solid black; text-align: center;
  transition: 0.4s var(--ease-royal);
}

.archive-tile:hover { transform: scale(1.03); border-bottom-color: var(--gold-primary); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
.archive-tile h4 { font-family: 'Cinzel', serif; font-size: 1rem; letter-spacing: 2px; margin-bottom: 5px; }
.archive-tile span { font-family: 'Noto Sans Ethiopic'; opacity: 0.7; font-weight: 700; color: var(--gold-deep); }

/* Decorative */
.bg-layer {
  position: absolute; inset: 0; background-size: cover; background-position: center;
  filter: brightness(0.2); z-index: -1; transform: scale(1.1);
}
`;

/* ----------------------------------------------------------------------------
   [UTILITY: COMPONENTS]
   ---------------------------------------------------------------------------- */

const Header = ({ activeSection }) => (
  <header className="site-header">
    <nav className="nav-rail">
      {['portal', 'mission', 'foundations', 'archive', 'communion'].map((id) => (
        <a 
          key={id} 
          href={`#${id}`} 
          className={`nav-btn ${activeSection === id ? 'active' : ''}`}
        >
          <h4>{id}</h4>
          <span>{id === 'portal' ? 'ቤት' : id === 'archive' ? 'ማኅደር' : 'ተልዕኮ'}</span>
        </a>
      ))}
    </nav>
  </header>
);

const FoundationPillar = ({ icon, title, amharic, children }) => {
  const [isOpen, setIsOpen] = useState(false);
  return (
    <div 
      className={`pillar-card ${isOpen ? 'is-active' : ''}`} 
      onClick={() => setIsOpen(!isOpen)}
    >
      <i className={`fas ${icon}`}></i>
      <h4>{title}</h4>
      <span style={{fontFamily: 'Noto Sans Ethiopic'}}>{amharic}</span>
      <div className="pillar-drawer">
        <p style={{fontFamily: 'Noto Sans Ethiopic', fontSize: '1.2rem', lineHeight: '2.2'}}>
          {children}
        </p>
      </div>
    </div>
  );
};

const ArchiveTile = ({ href, title, amharic }) => (
  <a href={href} className="archive-tile">
    <h4>{title}</h4>
    <span>{amharic}</span>
  </a>
);

/* ----------------------------------------------------------------------------
   [MAIN APPLICATION ENGINE]
   ---------------------------------------------------------------------------- */

const CovenantPortal = () => {
  const [activeSection, setActiveSection] = useState('portal');
  const scrollRef = useRef(null);

  useEffect(() => {
    const handleScroll = () => {
      const sections = ['portal', 'mission', 'foundations', 'archive', 'communion'];
      const current = sections.find(id => {
        const el = document.getElementById(id);
        if (el) {
          const rect = el.getBoundingClientRect();
          return rect.top >= -100 && rect.top <= 300;
        }
        return false;
      });
      if (current) setActiveSection(current);
    };

    const container = scrollRef.current;
    container.addEventListener('scroll', handleScroll);
    return () => container.removeEventListener('scroll', handleScroll);
  }, []);

  return (
    <div className="covenant-app">
      <style>{STYLES}</style>
      
      <Header activeSection={activeSection} />

      <main className="scroll-viewport" ref={scrollRef}>
        
        {/* PORTAL SECTION */}
        <section id="portal" className="vault-section">
          <div className="bg-layer" style={{backgroundImage: "url('https://images.unsplash.com/photo-1548003693-f140643900cc?q=80')"}}></div>
          <div className="glass-vault" style={{textAlign: 'center'}}>
            <div style={{width: '180px', height: '180px', margin: '0 auto 40px', background: 'white', borderRadius: '50%', padding: '10px', border: '2px solid var(--gold-primary)'}}>
              <img src="logo.jpg" alt="Logo" style={{width:'100%', height:'100%', borderRadius:'50%'}} />
            </div>
            <h1 style={{fontFamily: 'Cinzel Decorative', fontSize: '4rem', letterSpacing: '15px'}}>COVENANT OF JESUS</h1>
            <h2 style={{fontFamily: 'Noto Sans Ethiopic', fontSize: '2.5rem', color: 'var(--gold-primary)'}}>ኪዳን ዘኢየሱስ</h2>
          </div>
        </section>

        {/* MISSION SECTION */}
        <section id="mission" className="vault-section">
          <div className="bg-layer" style={{backgroundImage: "url('https://images.unsplash.com/photo-1519817650390-64a93db51149?q=80')"}}></div>
          <div className="glass-vault">
            <h2 style={{fontFamily: 'Cinzel', fontSize: '2.5rem', textAlign: 'center', marginBottom: '40px'}}>The Sacred Mission</h2>
            <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '40px'}}>
              <div style={{background: 'var(--parchment)', color: 'black', padding: '40px'}}>
                <h5 style={{color: 'var(--gold-deep)', marginBottom: '20px'}}>መግለጫ</h5>
                <p style={{fontFamily: 'Noto Sans Ethiopic', fontSize: '1.3rem', lineHeight: '2.2'}}>የዚህ ድረ-ገጽ ዋነኛ ዓላማ የጥንታዊቷን የኦሬንታል ኦርቶዶክስ ተዋሕዶ ቤተክርስቲያንን እምነትና ትምህርት በአእምሮአዊ ሙግት መከላከል ነው።</p>
              </div>
              <div style={{background: 'var(--parchment)', color: 'black', padding: '40px', fontStyle: 'italic'}}>
                <h5 style={{color: 'var(--gold-deep)', marginBottom: '20px'}}>STATEMENT</h5>
                <p style={{fontSize: '1.2rem', lineHeight: '1.8'}}>The primary mission of this portal is the intellectual preservation and defense of the Oriental Orthodox faith through ancient Patristic wisdom.</p>
              </div>
            </div>
          </div>
        </section>

        {/* FOUNDATIONS SECTION (EXPANDING FEATURE) */}
        <section id="foundations" className="vault-section">
          <div className="bg-layer" style={{backgroundImage: "url('https://images.unsplash.com/photo-1545063914-a1a6ec821acc?q=80')"}}></div>
          <div className="glass-vault">
            <h2 style={{fontFamily: 'Cinzel', fontSize: '2.5rem', textAlign: 'center', marginBottom: '50px'}}>Scholastic Foundations</h2>
            <div className="pillar-grid">
              <FoundationPillar icon="fa-scroll" title="Patristics" amharic="የአባቶች ትምህርት">
                የጥንት የቤተክርስቲያን አባቶች ያስተላለፉልንን ትምህርት በሥርዓት የምናጠናበት መሠረት ነው። ይህ ጥናት የቅዱሳት መጻሕፍትን ትርጓሜ እና የዶግማ መሠረቶችን ያካትታል።
              </FoundationPillar>
              <FoundationPillar icon="fa-brain" title="Philosophy" amharic="ፍልስፍና">
                ምክንያታዊ በሆነ መንገድ የእምነትን መሠረት የምንመረምርበት እና የምንከላከልበት ጥበብ ነው። እውነትን ከውሸት ለመለየት ሎጂካዊ ሙግቶችን እንጠቀማለን።
              </FoundationPillar>
              <FoundationPillar icon="fa-book-open" title="Scripture" amharic="ቅዱሳት መጻሕፍት">
                መጽሐፍ ቅዱስን ከመጀመሪያው ቋንቋው እና ከታሪካዊ አመጣጡ አንጻር የምናጠናበት ዘርፍ ነው። ጥናታችን የአባቶችን ትርጓሜ መሠረት ያደረገ ነው።
              </FoundationPillar>
            </div>
          </div>
        </section>

        {/* ARCHIVE SECTION (RESTORED LINKS) */}
        <section id="archive" className="vault-section">
          <div className="bg-layer" style={{backgroundImage: "url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?q=80')"}}></div>
          <div className="glass-vault">
            <h2 style={{fontFamily: 'Cinzel', fontSize: '2.5rem', textAlign: 'center', marginBottom: '50px'}}>Scholastic Archive</h2>
            <div className="archive-grid">
              <ArchiveTile href="library/catechism.html" title="Soul Prayers" amharic="ለሙታን ጸሎት" />
              <ArchiveTile href="library/ontological.html" title="Ontology" amharic="የህልውና ሙግት" />
              <ArchiveTile href="library/rebaptism.html" title="Re-baptism" amharic="ስለ ጥምቀት" />
              <ArchiveTile href="library/severus.html" title="St. Severus" amharic="ቅዱስ ሳዊሮስ" />
              <ArchiveTile href="library/confession.html" title="Meaning" amharic="የሕይወት ትርጉም" />
              <ArchiveTile href="library/josippon.html" title="Josippon" amharic="ዮሴፍ ወልደ ኮርዮን" />
            </div>
          </div>
        </section>

        {/* COMMUNION SECTION */}
        <section id="communion" className="vault-section">
          <div className="bg-layer" style={{backgroundImage: "url('https://images.unsplash.com/photo-1438232992991-995b7058bbb3?q=80')"}}></div>
          <div className="glass-vault" style={{textAlign: 'center'}}>
            <h1 style={{fontFamily: 'Cinzel', fontSize: '3.5rem', marginBottom: '20px'}}>Communion</h1>
            <h2 style={{fontFamily: 'Noto Sans Ethiopic', color: 'var(--gold-primary)', marginBottom: '40px'}}>የኅብረት መድረክ</h2>
            <a href="https://t.me/KidanZeIyesus" target="_blank" style={{display: 'inline-block', padding: '25px 80px', background: 'var(--gold-primary)', color: 'black', textDecoration: 'none', fontFamily: 'Cinzel', fontWeight: '900', letterSpacing: '5px', border: '2px solid white'}}>ENTER SANCTUARY</a>
          </div>
        </section>

      </main>

      <footer style={{height: '100px', background: 'black', display: 'flex', alignItems: 'center', justifyContent: 'center', fontFamily: 'Cinzel', fontSize: '0.7rem', letterSpacing: '5px', color: '#444'}}>
        COVENANT OF JESUS &copy; 2026 • ኪዳን ዘኢየሱስ • CONTRA MUNDUM
      </footer>
    </div>
  );
};

export default CovenantPortal;
